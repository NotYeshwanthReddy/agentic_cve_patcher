{
  "pre_checks": {
    "os_compatibility": {
      "command": "cat /etc/os-release",
      "expected": "Red Hat Enterprise Linux 8.10",
      "description": "Ensure the patch is applied only on RHEL 8.10 as specified in the RHSA advisory."
    },
    "package_dependency": {
      "command": "yum list installed | grep jq",
      "description": "Verify that jq is installed and that all dependent packages are available before applying the patch."
    },
    "environment_validation": {
      "command": "hostnamectl",
      "expected": "Production or Staging Environment",
      "description": "Ensure the system belongs to an appropriate environment (e.g., production or staging) as per the remediation scope."
    }
  },
  "check_packages": {
    "command": "rpm -q jq",
    "description": "Check the currently installed version of the jq package to ensure it's vulnerable."
  },
  "apply_remediation": {
    "command": "yum update jq -y",
    "type": "update",
    "description": "Apply the updated jq version (1.6-11.el8_10) provided in the RHSA-2025:10618 advisory to address the vulnerability."
  },
  "verify_fix": {
    "command": "rpm -q jq",
    "expected_result": "jq-1.6-11.el8_10 or higher installed",
    "description": "Verify that the updated jq version is installed and matches the fixed version."
  },
  "rollback_plan": {
    "command": "yum downgrade jq -y",
    "description": "Revert to the previous jq version if the patch causes issues or does not apply correctly."
  },
  "production_report": {
    "template_fields": [
      "vuln_id",
      "patch_applied",
      "verification_status",
      "notes",
      "os_validated",
      "env_validated"
    ],
    "description": "Document the validation of OS, environment, package details, and remediation status in the final post-remediation report."
  }
}