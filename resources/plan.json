{
  "pre_checks": {
    "os_compatibility": {
      "command": "cat /etc/os-release | grep 'Red Hat Enterprise Linux 8'",
      "expected": "Red Hat Enterprise Linux 8",
      "description": "Ensure patch applies only to RHEL 8 before execution."
    },
    "package_dependency": {
      "command": "yum list jq --installed",
      "description": "Verify jq package is installed and compatible before applying patch."
    },
    "environment_validation": {
      "command": "echo $ENVIRONMENT",
      "expected": "prod, dev, or stage matching patch conditions",
      "description": "Ensure this host belongs to the correct environment as outlined in vulnerability data."
    }
  },
  "check_packages": {
    "command": "yum list jq --installed",
    "description": "Check the current version of jq installed on the host."
  },
  "apply_remediation": {
    "command": "yum update jq",
    "type": "update",
    "description": "Update the jq package to the latest patched version to address vulnerabilities."
  },
  "verify_fix": {
    "command": "rpm -qa jq | grep '<expected patched version>'",
    "expected_result": "Patched version of jq is correctly installed.",
    "description": "Ensure the updated jq package resolves the identified vulnerabilities."
  },
  "rollback_plan": {
    "command": "yum downgrade jq",
    "description": "If the patch fails, rollback to the previous state by downgrading the jq package."
  },
  "production_report": {
    "template_fields": [
      "vuln_id",
      "patch_applied",
      "verification_status",
      "notes",
      "os_validated",
      "env_validated"
    ],
    "description": "Document OS compatibility, environment validation, and remediation status in the final report using provided template."
  }
}